{% extends 'base.html' %}
{% load static %}
{% block title %}–°–ø–∏—Å–æ–∫ –ø–µ—Å–µ–Ω{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
{% endblock %}

{% block content %}
<div class="container">
    <h1 class="page-title">üéµ –ú—É–∑—ã–∫–∞–ª—å–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è</h1>

    <!-- –ü–æ–∏—Å–∫ -->
    <form method="get" class="search-form">
        <div class="search-box">
            <input type="text" name="q" value="{{ request.GET.q }}" placeholder="–ü–æ–∏—Å–∫ –ø–æ –ø–µ—Å–Ω–µ –∏–ª–∏ –∞—Ä—Ç–∏—Å—Ç—É..." class="search-input">
            <button type="submit" class="search-btn">üîç</button>
        </div>
    </form>

    <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∂–∞–Ω—Ä–∞–º -->
    <div class="genre-filter">
        <strong>–ñ–∞–Ω—Ä—ã:</strong>
        <a href="{% url 'main' %}" class="genre-tag {% if not selected_genre %}active{% endif %}">–í—Å–µ</a>
        {% for genre in genres %}
            <a href="?genre={{ genre.id }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}"
               class="genre-tag {% if genre.id|stringformat:'s' == selected_genre %}active{% endif %}">
                {{ genre.name }}
            </a>
        {% endfor %}
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –ø–µ—Å–µ–Ω -->
    <div class="songs-grid">
        {% for song in songs %}
        <article class="song-card">
            <div class="song-cover">
                {% if song.album.cover %}
                    <img src="{{ song.album.cover.url }}" alt="{{ song.title }}">
                {% else %}
                    <img src="{% static 'no-image.png' %}" alt="–ù–µ—Ç –æ–±–ª–æ–∂–∫–∏">
                {% endif %}
            </div>
            <div class="song-info">
                <h3 class="song-title">{{ song.title }}</h3>
                <p class="song-meta">
                    <strong>–ê—Ä—Ç–∏—Å—Ç:</strong> <a href="{% url 'artist' %}" class="link">{{ song.artist.name }}</a><br>
                    <strong>–ê–ª—å–±–æ–º:</strong> {{ song.album.title }}<br>
                    <strong>–ñ–∞–Ω—Ä:</strong> <span class="genre-badge">{{ song.genre.name }}</span>
                </p>
                {% if song.audio_file %}
                    <audio controls class="audio-player">
                        <source src="{{ song.audio_file.url }}" type="audio/mpeg">
                        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ.
                    </audio>
                {% else %}
                    <p class="no-audio">–ê—É–¥–∏–æ—Ñ–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</p>
                {% endif %}
            </div>
        </article>
        {% empty %}
        <p class="empty-state">–ü–µ—Å–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}
